(function(){var a,b=[].slice;a=function(a,c,d,e){var f,g,h,i;return i=d(a.Epoxy.View),f=a.$,g=f("body"),h=i.extend({modal_keyboard:!1,modal_backdrop:!0,autoremove:!0,constructor:function(){var a,b,c;return a=this.initialize,this.initialize=function(b){return b||(b={}),this.autoremove=b.autoremove||this.autoremove,this.modal_backdrop=b.modal_backdrop||this.modal_backdrop,this.modal_keyboard=b.modal_keyboard||this.modal_keyboard,this.$modalEl=this.$el.find(".modal"),this.$modalEl.attr({tabindex:"-1"}),this.listenTo(this,"onShow",function(){return g.addClass("modal-open")}),this.listenTo(this,"onClose",function(a){return function(){return setTimeout(function(){return a.autoremove?a.remove():void 0},0)}}(this)),this.async=f.Deferred(),this.async.promise().always(function(a){return function(){return a.remove()}}(this)),this.isShown=!1,this._bindModal(),null!=a?a.apply(this,arguments):void 0},b=this.remove,c=!1,this.remove=function(){return c?void 0:(c=!0,this._unbindModal(),i.prototype.remove.apply(this,arguments),null!=b?b.apply(this,arguments):void 0)},i.prototype.constructor.apply(this,arguments)},showAnimation:function(a){return this.isShown===!0?"function"==typeof a?a():void 0:(this._bindModal(),this.$modalEl.one("shown.bs.modal",function(b){return function(){return b.isShown=!0,"function"==typeof a?a():void 0}}(this)),this.$modalEl.modal({backdrop:this.modal_backdrop,show:!0,keyboard:this.modal_keyboard}))},closeAnimation:function(a){return this.isShown===!1?"function"==typeof a?a():void 0:(this._unbindModal(),this.$modalEl.one("hidden.bs.modal",function(b){return function(){return b.isShown=!1,"function"==typeof a?a():void 0}}(this)),this.$modalEl.modal("hide"))},showModal:function(){return e.app.modal.show(this),this.async.promise()},showChainModal:function(){var a,c,d,e,f;return a=arguments[0],d=arguments[1],e=3<=arguments.length?b.call(arguments,2):[],c=this.autoremove,this.setAutoremove(!1),this.closeCurrent(),f=new a(d),f.showModal.apply(f,e).always(function(a){return function(){return a.setAutoremove(c),a.showCurrent()}}(this))},ok:function(a){return null==a&&(a={}),e.app.modal.close(this,function(b){return function(){return b.async.resolve(a)}}(this)),this.async.promise()},cancel:function(a){return null==a&&(a="error"),e.app.modal.close(this,function(b){return function(){return b.async.reject(a)}}(this)),this.async.promise()},setAutoremove:function(a){this.autoremove=null!=a?a:!0},_bindModal:function(){return this._unbindModal(),this.$modalEl.on("hidden.bs.modal",function(a){return function(){return a.isShown=!1,a.cancel("hide modal")}}(this))},_unbindModal:function(){return this.$modalEl.off("hidden.bs.modal")}}),h.version="0.0.9",h},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(["backbone","underscore","backbone-mixin","common","epoxy","bootstrap"],function(b,c,d,e){return a(b,c,d,e)}):window.BootstrapModal=a(Backbone,_,MixinBackbone,common)}).call(this);